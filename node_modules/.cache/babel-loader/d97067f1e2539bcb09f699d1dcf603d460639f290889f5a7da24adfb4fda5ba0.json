{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport QRCode from \"qrcode\";\nimport { sentClothImg } from \"../api/index\";\nlet inputElement = null;\nexport default {\n  data() {\n    return {\n      images: [{\n        src: require(\"@/assets/background.jpg\")\n      }, {\n        src: require(\"@/assets/beijing1.png\")\n      }, {\n        src: require(\"@/assets/loading.gif\")\n      }, {\n        src: require(\"@/assets/show.jpg\")\n      }],\n      qrCode: \"\",\n      // 这个是二维码图片的url\n      scrollSpeed: 0.5,\n      // 控制滚动的速度\n      scrollPosition: 0,\n      // 当前滚动位置\n      isHovered: null,\n      // 当前悬停的图片索引\n      clearTimer: null,\n      // 用来存储清除二维码的定时器\n      outUrl: require(\"@/assets/show.jpg\"),\n      valueUrl: '',\n      isImg: false,\n      // 控制加载动画显示与隐藏\n      style: \"\"\n    };\n  },\n  methods: {\n    generateQRCode(event) {\n      const link = document.createElement('a');\n      link.href = this.outUrl;\n      // 生成二维码逻辑(参数指定url文字即可)\n      QRCode.toDataURL(this.outUrl).then(async qr => {\n        this.qrCode = qr; // 设置二维码图片\n\n        // 每次生成二维码时，启动一个新的计时器，5秒后清除二维码\n        this.startClearTimer();\n      }).catch(error => {\n        console.error(\"生成二维码出错：\", error);\n      });\n      link.click();\n\n      // 阻止点击二维码按钮时事件传播，防止触发页面上的点击事件\n      event.stopPropagation();\n    },\n    // 启动清除二维码的定时器\n    startClearTimer() {\n      // 如果已有定时器，清除它\n      if (this.clearTimer) {\n        clearTimeout(this.clearTimer);\n      }\n\n      // 设置一个 5 秒后清除二维码的定时器\n      this.clearTimer = setTimeout(() => {\n        this.qrCode = \"\"; // 清除二维码\n      }, 10000); // 5秒后清除二维码\n    },\n    // 监听页面点击事件，点击时重置定时器\n    handleClick(event) {\n      // 判断点击的区域是否是二维码区域，如果是就不清除二维码，否则清除\n      const qrCodeElement = this.$el.querySelector('.win-erweima');\n\n      // 判断点击是否在二维码外\n      if (qrCodeElement && !qrCodeElement.contains(event.target)) {\n        this.qrCode = \"\"; // 清除二维码\n      }\n\n      // 每次点击时，重置计时器，防止自动清除二维码\n      this.startClearTimer();\n    },\n    nextImage() {\n      const scrollContainer = this.$refs.scrollContainer;\n      const imageWidth = scrollContainer.children[0].offsetWidth; // 获取单张图片的宽度\n\n      // 将第一张图片移到最后\n      const lastImage = this.images.pop();\n      this.images.unshift(lastImage);\n\n      // 判断是否超出范围，调整位置\n      if (this.scrollPosition <= -imageWidth * this.images.length) {\n        this.scrollPosition = 0; // 如果滚动超出范围，重置滚动位置\n      }\n    },\n    // 向左滚动（点击 preImg）\n    prevImage() {\n      const scrollContainer = this.$refs.scrollContainer;\n      const imageWidth = scrollContainer.children[0].offsetWidth; // 获取单张图片的宽度\n\n      // 将最后一张图片移到最前面\n      const firstImage = this.images.shift();\n      this.images.push(firstImage);\n\n      // 判断是否超出范围，调整位置\n      if (this.scrollPosition >= 0) {\n        this.scrollPosition = -imageWidth * (this.images.length - 1); // 如果回到第一张，设置为最后一张\n      }\n    },\n    toGetImg() {\n      if (inputElement === null) {\n        // 生成文件上传的控件\n        inputElement = document.createElement('input');\n        inputElement.setAttribute('type', 'file');\n        inputElement.style.display = 'none';\n        if (window.addEventListener) {\n          inputElement.addEventListener('change', this.uploadFile, false);\n        } else {\n          inputElement.attachEvent('onchange', this.uploadFile);\n        }\n        document.body.appendChild(inputElement);\n      }\n      inputElement.click();\n    },\n    uploadFile(el) {\n      if (el && el.target && el.target.files && el.target.files.length > 0) {\n        const files = el.target.files[0];\n        const isLt2M = files.size / 1024 / 1024 < 2;\n        if (!isLt2M) {\n          this.$message.error('上传图片大小不能超过 2MB!');\n        } else if (files.type.indexOf('image') === -1) {\n          this.$message.error('请选择图片文件');\n        } else {\n          const reader = new FileReader();\n          reader.readAsDataURL(files);\n          reader.onload = () => {\n            this.valueUrl = reader.result;\n          };\n        }\n      }\n    },\n    sentImage() {\n      if (!this.valueUrl) {\n        this.$message.error('请先上传图片');\n        return;\n      }\n      if (this.style == '') {\n        this.$message.error('请先选择背景');\n      } else {\n        this.$message({\n          message: '图片上传成功,正在生成',\n          type: 'success'\n        });\n        sentClothImg({\n          image: this.valueUrl.split(',')[1],\n          style: this.style.split(',')[1]\n        }).then(response => {\n          this.isImg = true;\n          const stylizedImage = response.data.stylized_image;\n          this.outUrl = 'data:image/jpeg;base64,' + stylizedImage;\n        }).catch(error => {\n          this.loading = false;\n          console.error('Error uploading image: ', error);\n        });\n      }\n    },\n    onMouseOver(index) {\n      this.isHovered = index; // 设置当前悬停的图片索引\n      this.style = this.images[index].src;\n    }\n  }\n};","map":{"version":3,"names":["QRCode","sentClothImg","inputElement","data","images","src","require","qrCode","scrollSpeed","scrollPosition","isHovered","clearTimer","outUrl","valueUrl","isImg","style","methods","generateQRCode","event","link","document","createElement","href","toDataURL","then","qr","startClearTimer","catch","error","console","click","stopPropagation","clearTimeout","setTimeout","handleClick","qrCodeElement","$el","querySelector","contains","target","nextImage","scrollContainer","$refs","imageWidth","children","offsetWidth","lastImage","pop","unshift","length","prevImage","firstImage","shift","push","toGetImg","setAttribute","display","window","addEventListener","uploadFile","attachEvent","body","appendChild","el","files","isLt2M","size","$message","type","indexOf","reader","FileReader","readAsDataURL","onload","result","sentImage","message","image","split","response","stylizedImage","stylized_image","loading","onMouseOver","index"],"sources":["src/views/HomeView.vue"],"sourcesContent":["<template>\n  <div class=\"clothing\" id=\"clothing-v\" @click=\"handleClick\">\n    <div class=\"overlay\" v-if=\"qrCode\"></div>\n    <div v-if=\"qrCode\" class=\"win-erweima\">\n      <img :src=\"qrCode\" style=\"width: 500px;height: 500px;border: 1px #CCCCCC solid;\" alt=\"QR Code\" />\n    </div>\n    <div class=\"win-up\" style=\"z-index: 1\">\n      <div class=\"win-show\">\n        <img\n            class=\"win-photo\"\n            :src=outUrl\n        >\n      </div>\n      <div class=\"all-button\">\n        <img\n            class=\"win-button\"\n            src=\"@/assets/shangchuan.png\"\n            @click=\"toGetImg\"\n        ><img\n          class=\"win-button\"\n          src=\"@/assets/build.png\"\n          @click=\"sentImage\"\n      ><img\n          class=\"win-button\"\n          src=\"@/assets/erweima.png\"\n          @click=\"generateQRCode\"\n      >\n      </div>\n    </div>\n    <div class=\"win-down\">\n      <img\n          src=\"@/assets/preImg.png\"\n          class=\"control-img pre-img\"\n          @click=\"prevImage\">\n\n      <img\n          src=\"@/assets/nexImg.png\"\n          class=\"control-img nex-img\"\n          @click=\"nextImage\">\n      <div class=\"gundong\">\n        <div class=\"topgun\">\n          <div ref=\"scrollContainer\" class=\"scroll-container\">\n            <!-- 初始图片 -->\n            <div\n                class=\"smallbox\"\n                v-for=\"(item, index) in images\"\n                @mouseover=\"onMouseOver(index)\"\n                :key=\"index\"\n                :class=\"{ highlighted: isHovered === index }\"\n            >\n              <img :src=\"item.src\" class=\"slide-image\" />\n            </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  </div>\n</template>\n\n<script>\nimport QRCode from \"qrcode\";\nimport {sentClothImg} from \"../api/index\";\n\nlet inputElement = null;\nexport default {\n  data() {\n    return {\n      images: [\n        { src: require(\"@/assets/background.jpg\") },\n        { src: require(\"@/assets/beijing1.png\") },\n        { src: require(\"@/assets/loading.gif\") },\n        { src: require(\"@/assets/show.jpg\") },\n      ],\n      qrCode: \"\", // 这个是二维码图片的url\n      scrollSpeed: 0.5, // 控制滚动的速度\n      scrollPosition: 0, // 当前滚动位置\n      isHovered: null, // 当前悬停的图片索引\n      clearTimer: null, // 用来存储清除二维码的定时器\n      outUrl:require(\"@/assets/show.jpg\"),\n      valueUrl:'',\n      isImg: false,  // 控制加载动画显示与隐藏\n      style: \"\",\n    };\n  },\n  methods: {\n    generateQRCode(event) {\n      const link = document.createElement('a');\n      link.href = this.outUrl;\n      // 生成二维码逻辑(参数指定url文字即可)\n      QRCode.toDataURL(this.outUrl)\n          .then(async (qr) => {\n            this.qrCode = qr; // 设置二维码图片\n\n            // 每次生成二维码时，启动一个新的计时器，5秒后清除二维码\n            this.startClearTimer();\n          })\n          .catch((error) => {\n            console.error(\"生成二维码出错：\", error);\n          });\n      link.click();\n\n      // 阻止点击二维码按钮时事件传播，防止触发页面上的点击事件\n      event.stopPropagation();\n    },\n\n    // 启动清除二维码的定时器\n    startClearTimer() {\n      // 如果已有定时器，清除它\n      if (this.clearTimer) {\n        clearTimeout(this.clearTimer);\n      }\n\n      // 设置一个 5 秒后清除二维码的定时器\n      this.clearTimer = setTimeout(() => {\n        this.qrCode = \"\"; // 清除二维码\n      }, 10000); // 5秒后清除二维码\n    },\n\n    // 监听页面点击事件，点击时重置定时器\n    handleClick(event) {\n      // 判断点击的区域是否是二维码区域，如果是就不清除二维码，否则清除\n      const qrCodeElement = this.$el.querySelector('.win-erweima');\n\n      // 判断点击是否在二维码外\n      if (qrCodeElement && !qrCodeElement.contains(event.target)) {\n        this.qrCode = \"\"; // 清除二维码\n      }\n\n      // 每次点击时，重置计时器，防止自动清除二维码\n      this.startClearTimer();\n    },\n\n    nextImage() {\n      const scrollContainer = this.$refs.scrollContainer;\n      const imageWidth = scrollContainer.children[0].offsetWidth; // 获取单张图片的宽度\n\n      // 将第一张图片移到最后\n      const lastImage = this.images.pop();\n      this.images.unshift(lastImage);\n\n      // 判断是否超出范围，调整位置\n      if (this.scrollPosition <= -imageWidth * this.images.length) {\n        this.scrollPosition = 0; // 如果滚动超出范围，重置滚动位置\n      }\n    },\n\n    // 向左滚动（点击 preImg）\n    prevImage() {\n      const scrollContainer = this.$refs.scrollContainer;\n      const imageWidth = scrollContainer.children[0].offsetWidth; // 获取单张图片的宽度\n\n      // 将最后一张图片移到最前面\n      const firstImage = this.images.shift();\n      this.images.push(firstImage);\n\n\n      // 判断是否超出范围，调整位置\n      if (this.scrollPosition >= 0) {\n        this.scrollPosition = -imageWidth * (this.images.length - 1); // 如果回到第一张，设置为最后一张\n      }\n    },\n    toGetImg() {\n      if (inputElement === null) {\n        // 生成文件上传的控件\n        inputElement = document.createElement('input')\n        inputElement.setAttribute('type', 'file')\n        inputElement.style.display = 'none'\n\n        if (window.addEventListener) {\n          inputElement.addEventListener('change', this.uploadFile, false)\n        } else {\n          inputElement.attachEvent('onchange', this.uploadFile)\n        }\n\n        document.body.appendChild(inputElement)\n      }\n      inputElement.click()\n    },\n    uploadFile(el) {\n      if (el && el.target && el.target.files && el.target.files.length > 0) {\n        const files = el.target.files[0];\n        const isLt2M = files.size / 1024 / 1024 < 2;\n\n        if (!isLt2M) {\n          this.$message.error('上传图片大小不能超过 2MB!');\n        } else if (files.type.indexOf('image') === -1) {\n          this.$message.error('请选择图片文件');\n        } else {\n          const reader = new FileReader();\n          reader.readAsDataURL(files);\n          reader.onload = () => {\n            this.valueUrl = reader.result;\n\n          };\n\n        }\n      }\n    },\n    sentImage(){\n      if (!this.valueUrl) {\n        this.$message.error('请先上传图片');\n        return;\n      }\n      if(this.style==''){\n        this.$message.error('请先选择背景');\n      }else{\n        this.$message({\n          message: '图片上传成功,正在生成',\n          type: 'success'\n        });\n        sentClothImg({\n          image: this.valueUrl.split(',')[1],\n          style: this.style.split(',')[1]\n        })\n            .then(response => {\n              this.isImg = true\n              const stylizedImage = response.data.stylized_image;\n              this.outUrl = 'data:image/jpeg;base64,' + stylizedImage;\n            })\n            .catch(error => {\n              this.loading = false;\n              console.error('Error uploading image: ', error);\n            });\n      }\n    },\n    onMouseOver(index) {\n      this.isHovered = index;// 设置当前悬停的图片索引\n      this.style = this.images[index].src;\n    },\n  },\n};\n</script>\n\n<style scoped>\n.clothing {\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  align-items: flex-start;\n}\n\n#clothing-v {\n  background: url(\"@/assets/background.jpg\");\n  width: 100%;\n  height: 100%;\n  background-size: 100% 100%;\n}\n\n.win-up {\n  width: 100%;\n  height: 55%;\n  margin-top: 9%;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n}\n\n.win-down {\n  margin-top: 1.5%;\n  margin-left: 1%;\n  width: 76%;\n  height: 25%;\n  margin-bottom: 0.5%;\n  background-color: white;\n  border-radius: 1vw;\n  position: relative;\n}\n\n.win-button {\n  width: 200px;\n  height: 80px;\n  cursor: pointer;\n}\n\n.win-show {\n  width: 80%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: flex-end;\n}\n\n.all-button {\n  width: 20%;\n  height: 80%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: flex-end;\n}\n\n.win-photo {\n  width: 46.4vw;\n  height: 54.37vh;\n}\n\n.win-erweima {\n  position: absolute;\n  top: 50vh;\n  left: 50%;\n  width: 500px;\n  height: 500px;\n  transform: translate(-50%, -50%);\n  z-index: 9999;\n}\n\n.overlay {\n  position: absolute;\n  width: 100vw;\n  height: 100vh;\n  background-color: rgba(0, 0, 0, 0.5);\n  z-index: 100;\n}\n\n.gundong {\n  width: 100%;\n  height: 100%;\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n}\n\n.topgun {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  overflow: hidden;\n}\n\n.scroll-container {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  transition: transform 0.2s ease-out;\n}\n\n.smallbox {\n  margin-left: 1vh;\n  width: 24.15%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  flex: 0 0 auto;\n}\n\nimg.slide-image {\n  border: 0.2vw solid transparent;\n  width: 100%;\n  height: 80%;\n}\n\n.highlighted img {\n  border: 0.2vw solid #ff6f00;\n  cursor: pointer;\n  transform: scale(1.02); /* 放大图片 */\n}\n.control-img {\n  height: 25%;\n  width: 5%;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  z-index: 10;\n}\n.control-img:hover{\n  cursor: pointer;\n}\n.pre-img {\n  left: 0;\n}\n\n.nex-img {\n  right: 0;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}